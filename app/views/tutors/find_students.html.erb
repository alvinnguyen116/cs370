<%= stylesheet_link_tag "tutors_index" %>

<% if notice %>
  <%= render "notice_danger" %>
<% end %>

<h1 style="padding-bottom: 10px;">Students</h1>
<script>
	function showEmailForm(email) {
		// document.getElementById("email-form").style.
		console.log('params email', email);
		$("#student-email").val(email);
		$("#email-form").css({'opacity' : 1, 'z-index':1});
	}
	
	function hideEmailForm() {
		console.log('student email', $("#student-email").val());
		
		$("#email-form").css({'opacity' : 0, 'z-index':0});
	}
</script>

<form id="email-form" action="" method="" 
style="
opacity: 0;
position: absolute;
top: 0;
left: 0;
width: 100vw;
height: 100vh;
background: #00000040;
z-index: 0;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
transition: opacity .1s linear;
">
<div style="
	display: flex;
    flex-direction: column;
    width: 50%;
    "
>
	<h1 style="
	    background: white;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 3px;
    padding: 3px 30px;
	">Email Body</h1>
	<input id="student-email" type="hidden" value="">
	<input type="textarea" style="
    height: 200px;
	">
	<input class="btn btn-primary" type="submit" value="send" onclick="hideEmailForm()" style="
	margin-top: 10px;
	">
</div>
</form>


<% @true_classes.each do |true_class| %>
    <table>
    <h1><%=true_class %> </h1>
    <tbody id="tutor_table">
    <% course_obj = Course.where(true_class == :name).first %>
    <% requests_obj = Request.where(course_obj.id == :course_id) %>
    <% requests_obj.each do |req| %>
        <% tutee = @tutees.find(req.tutee_id) %>
        <%if tutee.privilege != 'No'%>
            <tr>
                <td><%= tutee.first_name + ' ' + tutee.last_name%></td>
                <td><%= req.subject%></td>
                <td><button onclick="showEmailForm('<%= tutee.email %>')">Email</button></td>
            </tr>
        <% end %>
    <% end %>   
    <% requests_obj.each do |req| %>
        <% tutee = @tutees.find(req.tutee_id) %>
        <%if tutee.privilege == 'No'%>
            <tr>
                <td><%= tutee.first_name + ' ' + tutee.last_name%></td>
                <td><%= req.subject%></td>
                <td><button onclick="showEmailForm('<%= tutee.email %>')">Email</button></td>
            </tr>
        <% end %>
    <% end %>
    </tbody>
    </table>
 <% end %>